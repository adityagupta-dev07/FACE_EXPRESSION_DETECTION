<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mood Booster</title>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Consolas, monospace;
}

/* ================= BACKGROUND ================= */
body {
  min-height: 100vh;
  background:
    linear-gradient(180deg, rgba(0,60,55,0.9), rgba(0,0,0,0.95)),
    repeating-linear-gradient(
      90deg,
      rgba(0,255,204,0.05) 0px,
      rgba(0,255,204,0.05) 1px,
      transparent 1px,
      transparent 80px
    );
  color: #00ffcc;
}

/* ================= INTRO ================= */
#intro {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle, #002b2b, #000);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 10;
}

#intro h1 {
  font-size: 2.4rem;
  margin-bottom: 20px;
  text-shadow: 0 0 25px #00ffcc;
}

#intro input {
  padding: 12px;
  width: 260px;
  background: black;
  border: 2px solid #00ffcc;
  color: #00ffcc;
  font-size: 1rem;
  margin-bottom: 15px;
}

#intro button {
  padding: 10px 35px;
  background: #00ffcc;
  border: none;
  cursor: pointer;
  box-shadow: 0 0 20px #00ffcc;
}

/* ================= HEADER ================= */
.header {
  text-align: center;
  padding: 18px 10px;
  font-size: 2rem;
  text-shadow: 0 0 25px #00ffcc;
  border-bottom: 1px solid rgba(0,255,204,0.3);
}

/* ================= MAIN ================= */
.main {
  display: none;
  gap: 28px;
  padding: 25px;
  justify-content: center;
}

.card {
  background: rgba(0,0,0,0.65);
  border-radius: 22px;
  padding: 16px;
  border: 1px solid rgba(0,255,204,0.45);
  box-shadow:
    0 0 25px rgba(0,255,204,0.25),
    inset 0 0 20px rgba(0,255,204,0.12);
}

.camera-card {
  flex: 1.35;
  display: flex;
  flex-direction: column;
}

.camera-card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 16px;
}

.detected {
  text-align: center;
  margin-top: 12px;
  font-size: 1.1rem;
}

.meme-card {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
}

.meme-title {
  font-size: 1.5rem;
  text-shadow: 0 0 12px #00ffcc;
}

.meme-card img {
  width: 100%;
  max-height: 70%;
  border-radius: 16px;
  box-shadow: 0 0 18px rgba(0,255,204,0.7);
}

.meme-footer {
  font-size: 1.1rem;
}
</style>
</head>

<body>

<!-- INTRO -->
<div id="intro">
  <h1>Apna naam batao babua ðŸ˜Ž</h1>
  <input id="username" placeholder="Enter your name">
  <button onclick="startApp()">Enter</button>
</div>

<!-- HEADER -->
<div class="header" id="headerText"></div>

<!-- MAIN -->
<div class="main" id="app">

  <div class="card camera-card">
    <img src="/video_feed">
    <div class="detected">
      Detected Expression: <span id="label">neutral</span>
    </div>
  </div>

  <div class="card meme-card">
    <div class="meme-title">kuch khaas nahi ðŸ˜Œ</div>
    <img id="memeImg" src="/static/memes/neutral.gif">
    <div class="meme-footer">jeevan waste hai mera ðŸ˜Œ</div>
  </div>

</div>

<script>
/* ================= PRELOAD GIFS (FIXES HAPPY LAG) ================= */
const emotions = [
  "neutral","happy","sad","angry","surprise","fear","thinking","idea"
];

emotions.forEach(e => {
  const img = new Image();
  img.src = `/static/memes/${e}.gif`;
});

let lastEmotion = "";

function startApp() {
  const name = document.getElementById("username").value || "Babua";
  document.getElementById("intro").style.display = "none";
  document.getElementById("app").style.display = "flex";
  document.getElementById("headerText").innerText =
    `Aaiye, aapka mood sudhaare â€“ ${name} ðŸ˜„`;
}

const emotionUI = {
  neutral:{title:"kuch khaas nahi ðŸ˜Œ",caption:"jeevan waste hai mera ðŸ˜Œ"},
  happy:{title:"Mood bangya ji ðŸ˜„",caption:"uska story pe reply aane ke baad mai âœ¨"},
  sad:{title:"Dil bhar aaya ðŸ˜¢",caption:"thoda ro lene se halka ho jaata hai"},
  angry:{title:"Gussa ðŸ˜¤",caption:"shaant ho ja boss"},
  surprise:{title:"Shock ðŸ˜²",caption:"ye kya ho gaya"},
  fear:{title:"Darr ðŸ˜¨",caption:"sab theek hai"},
  thinking:{title:"Thinking ðŸ¤”",caption:"dimaag full busy"},
  idea:{title:"IDEA ðŸ’¡",caption:"yeh kaam karega ðŸ”¥"}
};

/* ================= LIVE UPDATE ================= */
setInterval(() => {
  fetch("/emotion?_=" + Date.now())
    .then(r => r.json())
    .then(d => {
      if (!d.emotion) return;

      const emotion = d.emotion;
      if (emotion === lastEmotion) return;
      lastEmotion = emotion;

      label.innerText = emotion;
      memeImg.src = `/static/memes/${emotion}.gif`;

      document.querySelector(".meme-title").innerText =
        emotionUI[emotion].title;
      document.querySelector(".meme-footer").innerText =
        emotionUI[emotion].caption;
    });
}, 250);
</script>

</body>
</html>
