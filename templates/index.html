<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Expression Detector</title>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: Consolas, monospace;
}

body {
    background: black;
    color: #00ffcc;
    height: 100vh;
    overflow: hidden;
}

/* MATRIX */
canvas {
    position: fixed;
    top: 0;
    left: 0;
    z-index: -1;
}

/* HEADER */
header {
    text-align: center;
    padding: 8px;
    border-bottom: 1px solid #00ffcc44;
}

header h1 {
    text-shadow: 0 0 10px #00ffcc;
}

/* LAYOUT */
.container {
    display: grid;
    grid-template-columns: 65% 35%;
    gap: 15px;
    padding: 15px;
    height: calc(100vh - 55px);

    align-items: center;          /* ðŸ”¥ CENTER CONTENT VERTICALLY */
    margin-top: -10px;            /* ðŸ”¥ MOVE UP SLIGHTLY */
}

/* CAMERA */
.video-box {
    border: 1px solid #00ffcc55;
    border-radius: 10px;
    padding: 8px;

    display: flex;
    flex-direction: column;
    align-items: center;          /* ðŸ”¥ CENTER TEXT & VIDEO */
}

.video-box img {
    width: 100%;
    border-radius: 8px;
}

.video-box p {
    margin-top: 6px;
    font-size: 14px;
    text-align: center;           /* ðŸ”¥ CENTER TEXT */
}

/* SIDE PANEL */
.panel {
    border: 1px solid #00ffcc55;
    border-radius: 10px;
    padding: 10px;

    display: flex;
    flex-direction: column;
    align-items: center;          /* ðŸ”¥ CENTER CONTENT */
    justify-content: center;      /* ðŸ”¥ CENTER VERTICALLY */
}

.panel h2 {
    text-align: center;
    margin-bottom: 10px;
}

/* MEME */
.meme-box {
    text-align: center;
}

.meme-box img {
    width: 90%;
    max-height: 280px;
    object-fit: contain;
    border-radius: 8px;
    box-shadow: 0 0 15px #00ffcc55;
}

.caption {
    margin-top: 8px;
    font-size: 14px;
}
</style>
</head>

<body>

<canvas id="matrix"></canvas>

<header>
    <h1>Expression Detector</h1>
</header>

<div class="container">

    <!-- CAMERA -->
    <div class="video-box">
        <img src="{{ url_for('video') }}">
        <p>Detected Expression: {{ expression }}</p>
    </div>

    <!-- MEME PANEL -->
    <div class="panel">
        <h2>{{ meme_name }}</h2>

        <div class="meme-box">
            <img id="meme-img"
                 src="{{ url_for('static', filename='memes/' + image) }}">
            <p class="caption">{{ caption }}</p>
        </div>
    </div>

</div>

<!-- MATRIX JS -->
<script>
const canvas = document.getElementById("matrix");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const letters = "01";
const fontSize = 14;
const columns = canvas.width / fontSize;
const drops = Array.from({ length: columns }).fill(1);

function drawMatrix() {
    ctx.fillStyle = "rgba(0,0,0,0.05)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = "#00ffcc";
    ctx.font = fontSize + "px monospace";

    for (let i = 0; i < drops.length; i++) {
        const text = letters[Math.floor(Math.random() * letters.length)];
        ctx.fillText(text, i * fontSize, drops[i] * fontSize);

        if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
            drops[i] = 0;
        }
        drops[i]++;
    }
}
setInterval(drawMatrix, 35);

/* ðŸ” AUTO-REFRESH MEME ONLY */
setInterval(() => {
    const memeImg = document.getElementById("meme-img");
    memeImg.src = memeImg.src.split("?")[0] + "?t=" + new Date().getTime();
}, 1000);
</script>

</body>
</html>
